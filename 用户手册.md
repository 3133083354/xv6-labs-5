Lab5：I/O设备与网卡驱动 - 用户手册

一、实验环境准备
1.1 环境要求
（1）Ubuntu/Linux 系统
（2）Python 3.x（用于测试脚本）
（3）至少2个终端窗口
（4）确保在xv6源码根目录下操作


1.2 进入实验环境
（1）进入xv6实验目录
cd ~/xv6-labs-2024
（2）清理之前的编译文件
make clean


二、编译与启动xv6系统
2.1 编译xv6内核
在第一个终端窗口中
make qemu
2.2 成功启动的标志
当看到以下输出时，表示xv6系统已成功启动：
xv6 kernel is booting

hart 2 starting
hart 1 starting
init: starting sh
$ 
此时出现 $ 提示符，表示可以输入命令。

三、测试准备
3.1 测试脚本位置

所有测试脚本位于xv6源码根目录下：
nettest.py：Python测试脚本
user/nettest.c：xv6内的测试程序

3.2 需要两个终端窗口
终端1：用于运行xv6系统（make qemu）
终端2：用于运行Python测试脚本

四、三个核心测试
4.1 测试1：发送功能测试（e1000_transmit）
测试目的：验证网卡发送数据包功能是否正常。
测试步骤：
（1）终端2 - 启动测试服务器：
python3 nettest.py txone
可能的输出示例：（也有可能不会有输出）
listening on lo port 25193
Waiting for packet...
（2）终端1 - 在xv6中运行发送测试：
$ nettest txone
观察结果：
成功：终端2显示 txone: OK
失败：终端2显示错误信息，或xv6中无响应

4.2 测试2：接收功能测试（e1000_recv）
测试目的：验证网卡接收数据包功能是否正常。
测试步骤：
（1）终端1 - 确保xv6正在运行（如果退出了需要重新 make qemu）
（2）终端2 - 发送测试数据包：
python3 nettest.py rxone
观察结果：
成功：终端1（xv6）显示：
arp_rx: received an ARP packet
ip_rx: received an IP packet
失败：无输出





4.3 测试3：完整功能测试（UDP系统调用）
测试目的：验证完整的UDP收发功能，包括系统调用。
测试步骤：
（1）终端2 - 启动完整测试：
python3 nettest.py grade
可能的输出示例：
listening on lo port 27643
Waiting for packet...
（2）终端1 - 在xv6中运行完整测试：
$ nettest grade
观察结果：
成功：终端2显示一系列测试通过，最后显示 ALL TESTS PASSED
终端1最后显示 free: OK
失败：测试过程中出现错误信息
